(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{494:function(e,t,r){"use strict";r.r(t),r.d(t,"NotePreview",(function(){return g}));var a=r(0),n=r.n(a),s=r(147),c=r(220),o=r(489),i=r.n(o),l=r(490),u=r.n(l),d=r(6),h={type:"output",regex:'<input type="checkbox" disabled',replace:'<input type="checkbox" '},p=e=>r.e(19).then(r.t.bind(null,971,7)).then(t=>{var{default:r}=t;r.extension("enableCheckboxes",h);var a=new r.Converter({extensions:["enableCheckboxes"]});a.setFlavor("github"),a.setOption("simpleLineBreaks",!1),a.setOption("ghMentions",!1),a.setOption("smoothLivePreview",!0),a.setOption("tables",!0),a.setOption("strikethrough",!0);var n=e.replace(/([ \t\u2000-\u200a]*)\u2022(\s)/gm,"$1-$2");return(e=>{for(var t=(new DOMParser).parseFromString(e,"text/html"),r=t.createTreeWalker(t.body,NodeFilter.SHOW_ALL,null,!1),a=[],n=[],s=function(){var e=r.currentNode;if((e=>{switch(e.nodeName.toLowerCase()){case"head":case"html":case"iframe":case"link":case"meta":case"object":case"script":case"style":return!0;default:return!1}})(e))return n.push(e),"continue";if(!(e=>{var t=e.nodeName.toLowerCase();if("input"===t)return"checkbox"===e.getAttribute("type");switch(t){case"#text":case"a":case"article":case"b":case"br":case"blockquote":case"cite":case"code":case"dd":case"del":case"div":case"dt":case"em":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"hr":case"i":case"img":case"ins":case"kbd":case"li":case"ol":case"p":case"pre":case"s":case"span":case"strong":case"sub":case"sup":case"table":case"tbody":case"td":case"th":case"thead":case"tr":case"tt":case"ul":return!0;default:return!1}})(e))return a.push(e),"continue";var t=e.nodeName.toLowerCase();Object(d.filter)(e.attributes,e=>{var{name:r,value:a}=e;return!((e,t,r)=>{switch(e){case"a":switch(t){case"href":return["http","https","simplenote"].includes(r.toLowerCase().trim().split("://")[0]);case"alt":case"rel":case"title":return!0;default:return!1}case"img":switch(t){case"alt":case"src":case"title":case"width":return!0;default:return!1}case"input":switch(t){case"disabled":case"checked":case"type":return!0;default:return!1}case"li":switch(t){case"class":switch(r){case"task-list-item":return!0;default:return!1}default:return!1}case"ol":switch(t){case"start":return!0;default:return!1}case"th":case"td":switch(t){case"style":switch(r){case"text-align:center;":case"text-align:left;":case"text-align:right;":return!0;default:return!1}default:return!1}default:return!1}})(t,r,a)&&(("href"!==r&&"src"!==r||!u.a.isWebUri(a))&&("href"!==r||!a.startsWith("mailto:")||!i.a.validate(a.slice(7))))}).forEach(t=>{var{name:r}=t;return e.removeAttribute(r)});var s="a"===t&&e.getAttribute("href");"a"!==t||"string"!=typeof s||s.startsWith("mailto:")||(e.setAttribute("target","_blank"),e.setAttribute("rel","external noopener noreferrer")),"li"===t&&"task-list-item"===e.getAttribute("class")&&e.setAttribute("style","list-style: none;")};r.nextNode();)s();return n.forEach(e=>{try{var t;null==e||null===(t=e.parentNode)||void 0===t||t.removeChild(e)}catch(e){}}),a.forEach(e=>{var t,r=e.parentNode;try{for(;t=e.firstChild;)null==r||r.insertBefore(t,e);null==r||r.removeChild(e)}catch(e){}}),t.body.innerHTML})(a.makeHtml(n))}),v=(e,t)=>{var r=e.parentNode;t.forEach(e=>{r.childNodes.forEach(r=>{var a,n,s;if(r.nodeType===Node.TEXT_NODE&&null!==(a=r.textContent)&&void 0!==a&&a.toLocaleLowerCase().includes(e)){var c=null===(n=r.textContent)||void 0===n?void 0:n.toLocaleLowerCase().indexOf(e),o=r.splitText(c),i=o.splitText(e.length),l=document.createElement("span");l.setAttribute("class","search-match"),null===(s=o.parentNode)||void 0===s||s.replaceChild(l,o),l.appendChild(o),v(i,t)}})})},f=(e,t,a)=>p(t).then(t=>(e.innerHTML=t,e)).then(e=>{if(!a)return e.querySelectorAll("pre code");var t=Object(c.a)(a).map(e=>e.toLocaleLowerCase());if(!t.length)return e.querySelectorAll("pre code");for(var r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:function(e){return t.some(t=>{var r;return null===(r=e.textContent)||void 0===r?void 0:r.toLocaleLowerCase().includes(t)})?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},!1),n=[],s=r.currentNode;s;)n.push(s),s=r.nextNode();return n.forEach(e=>v(e,t)),e.querySelectorAll("pre code")}).then(e=>{if(e.length)return r.e(14).then(r.t.bind(null,970,7)).then(t=>{var{default:r}=t;e.forEach(r.highlightBlock)}).catch()}),m=r(35),b=r(264),w=r(159),g=e=>{var t,{editNote:r,isFocused:s,note:c,noteId:o,notes:i,openNote:l,searchQuery:u,showRenderedView:d}=e,h=Object(a.useRef)();return Object(a.useEffect)(()=>{var e=e=>{if(!s)return!0;if(!document.getSelection().isCollapsed)return!0;var t=document.createElement("div");f(t,c.content,u).then(()=>{try{e.clipboardData.setData("text/plain",t.innerHTML)}catch(e){navigator.clipboard.writeText(t.innerHTML)}}),e.preventDefault()};return document.addEventListener("copy",e,!1),()=>document.removeEventListener("copy",e,!1)},[s,u]),Object(a.useEffect)(()=>{var e,t=e=>{for(var t=e.target;null!==t;t=t.parentNode){if("A"===t.tagName){e.preventDefault(),e.stopPropagation();var a=t;if(a.href.startsWith("simplenote://note/")){var n=/^simplenote:\/\/note\/(.+)$/.exec(a.href);if(!n)return;var[s,u]=n;return void(i.has(u)&&l(u))}return void(a.href.startsWith("http://localhost")||Object(m.a)(a.href))}if("task-list-item"===t.className){var d=function(){e.preventDefault(),e.stopPropagation();var a=h.current.querySelectorAll("[data-markdown-root] .task-list-item"),n=Array.prototype.indexOf.call(a,t),s=0,i=c.content.replace(/(- \[x\]|- \[ \])/g,e=>s++===n?"- [ ]"===e?"- [x]":"- [ ]":e);return r(o,{content:i}),{v:void 0}}();if("object"==typeof d)return d.v}}};return null===(e=h.current)||void 0===e||e.addEventListener("click",t,!0),()=>{var e;return null===(e=h.current)||void 0===e?void 0:e.removeEventListener("click",t,!0)}},[c]),Object(a.useEffect)(()=>{var e;h.current&&(null!=c&&c.content&&d?f(h.current,c.content,u):h.current.innerText=Object(b.a)(null!==(e=null==c?void 0:c.content)&&void 0!==e?e:""))},[null==c?void 0:c.content,u,d]),n.a.createElement("div",{className:"note-detail-wrapper"},n.a.createElement("div",{className:"note-detail note-detail-preview"},n.a.createElement("div",{ref:h,className:"note-detail-markdown theme-color-bg theme-color-fg","data-markdown-root":!0},n.a.createElement("div",{style:{whiteSpace:"pre"}},!d&&Object(b.a)(null!==(t=null==c?void 0:c.content)&&void 0!==t?t:"")))))},N={editNote:w.a.data.editNote,openNote:w.a.ui.selectNote};t.default=Object(s.b)((e,t)=>{var r,a,n=null!==(r=t.noteId)&&void 0!==r?r:e.ui.openedNote,s=null!==(a=t.note)&&void 0!==a?a:e.data.notes.get(n);return{isFocused:0===e.ui.dialogs.length&&!e.ui.showNoteInfo,note:s,noteId:n,notes:e.data.notes,searchQuery:e.ui.searchQuery,showRenderedView:!(null==s||!s.systemTags.includes("markdown")||e.ui.editMode)}},N)(g)}}]);